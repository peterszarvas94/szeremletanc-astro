---
import { search } from "../api/search";
import Node from "../components/Node.astro";
import Posts from "../components/Posts.astro";
import Layout from "../layouts/Layout.astro";
import type { Node as NodeType } from "../types/Node";

const { uri } = Astro.params;

let node: NodeType = null;
if (uri) {
  node = await search(uri);
  if (node === null) {
    return Astro.redirect("/404");
  }
}

let isPageForPosts: boolean = false;
if (node?.type === "page" && node.menu_order === 100) {
  isPageForPosts = true;
}
---

<Layout title={`${node?.title.rendered} - Szeremlei Néptáncegyüttes`}>
  {isPageForPosts ? <Posts node={node} /> : <Node node={node} />}
</Layout>
